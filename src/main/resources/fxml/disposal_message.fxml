<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.geometry.Insets?>

<VBox xmlns="http://javafx.com/javafx/21"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.kiosk.controllers.DisposalMessageController"
      alignment="CENTER"
      spacing="20"
      styleClass="root-container"
      stylesheets="@../css/kiosk-styles.css">
    
    <padding>
        <Insets top="20" right="40" bottom="20" left="40"/>
    </padding>

    <!-- Live Camera Feed - Centered -->
    <VBox fx:id="cameraContainer" 
          alignment="CENTER" 
          spacing="10"
          styleClass="camera-container">
        
        <Label text="Live Camera Feed" styleClass="camera-title"/>
        
        <StackPane styleClass="camera-frame">
            <ImageView fx:id="cameraFeedView" 
                       fitWidth="400" 
                       fitHeight="300"
                       preserveRatio="true"/>
            
            <VBox fx:id="cameraErrorOverlay" 
                  alignment="CENTER" 
                  spacing="10"
                  styleClass="camera-error-overlay"
                  visible="false">
                <Label text="⚠" styleClass="camera-error-icon"/>
                <Label text="Camera Unavailable" styleClass="camera-error-text"/>
                <Label fx:id="cameraErrorMessage" 
                       text="Please check camera connection" 
                       styleClass="camera-error-detail"/>
            </VBox>
        </StackPane>
        
        <HBox spacing="10" alignment="CENTER">
            <Button text="Start Feed" onAction="#startCameraFeed" styleClass="camera-button"/>
            <Button text="Stop Feed" onAction="#stopCameraFeed" styleClass="camera-button-secondary"/>
        </HBox>
    </VBox>
    
    <!-- Scanning Overlay (initially hidden) -->
    <StackPane fx:id="scanningOverlay" 
               styleClass="scanning-overlay"
               visible="false"
               minHeight="80">
        <VBox alignment="CENTER" spacing="10">
            <Label fx:id="scanningLabel" styleClass="scanning-title" text="Scanning..."/>
            <Label fx:id="scanningMessageLabel" styleClass="scanning-message" text="Hold item in front of camera"/>
        </VBox>
    </StackPane>

    <!-- Message Container (initially hidden) -->
    <VBox fx:id="messageContainer" 
          alignment="CENTER" 
          spacing="10" 
          styleClass="message-container"
          maxWidth="600"
          visible="false">
        <Label fx:id="iconLabel" styleClass="icon-label" text="♻"/>
        <Label fx:id="categoryLabel" styleClass="category-label" text="Recycling" wrapText="true"/>
        <Label fx:id="instructionLabel" styleClass="instruction-label" 
               text="Place plastic bottles, aluminum cans, paper, and cardboard in this bin." wrapText="true"/>
    </VBox>

    <!-- Confirmation Container (initially hidden) -->
    <VBox fx:id="confirmationContainer" 
          alignment="CENTER" 
          spacing="10" 
          styleClass="confirmation-container"
          maxWidth="600"
          visible="false">
        <Label fx:id="checkmarkLabel" styleClass="checkmark-label" text="✓"/>
        <Label fx:id="confirmationLabel" styleClass="confirmation-text" text="Correct Disposal!" wrapText="true"/>
    </VBox>
    
    <!-- Model Toggle -->
    <HBox spacing="15" alignment="CENTER">
        <Label text="ML Model:"/>
        <Button fx:id="chrisModelButton" text="Chris" onAction="#selectChrisModel" styleClass="model-button-selected"/>
        <Button fx:id="josephModelButton" text="Joseph" onAction="#selectJosephModel" styleClass="model-button"/>
    </HBox>

    <!-- Control Buttons -->
    <HBox spacing="15" alignment="CENTER">
        <Button text="▶ Start Scanning" onAction="#startScanning" styleClass="test-button"/>
        <Button text="⏹ Stop Scanning" onAction="#stopScanning" styleClass="test-button"/>
    </HBox>
    
    <!-- Test Buttons -->
    <HBox spacing="10" alignment="CENTER">
        <Button text="Recycle" onAction="#testRecycle" styleClass="test-button"/>
        <Button text="Trash" onAction="#testTrash" styleClass="test-button"/>
        <Button text="Compost" onAction="#testCompost" styleClass="test-button"/>
        <Button text="Hazardous" onAction="#testHazardous" styleClass="test-button"/>
    </HBox>

    <HBox spacing="10" alignment="CENTER">
        <Button text="✓ Recycle" onAction="#testCorrectRecycle" styleClass="test-button"/>
        <Button text="✓ Trash" onAction="#testCorrectTrash" styleClass="test-button"/>
        <Button text="✓ Compost" onAction="#testCorrectCompost" styleClass="test-button"/>
        <Button text="✓ Hazardous" onAction="#testCorrectHazardous" styleClass="test-button"/>
    </HBox>

    <HBox spacing="10" alignment="CENTER">
        <Button text="❌ Test Incorrect" onAction="#testIncorrectDisposal" styleClass="test-button"/>
    </HBox>

</VBox>